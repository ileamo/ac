#!/bin/sh
id=$(getprop ro.isn)
id=android
if [ -z "$id" ]
then
   id=$(getprop ro.serialno)
fi

if [ $1 = l ]
then
  loc=$(termux-location)
  lat=$(echo $loc | jq .latitude)
  lng=$(echo $loc | jq .longitude)
  params={\"id\":\"$id\",\"latitude\":$lat,\"longitude\":$lng}
else
  params={\"id\":\"$id\"}
fi

curl -H "Content-Type: application/json" \
    --silent --show-error --insecure \
    -X POST \
    -d  "{\"method\":\"get.conf\",\"params\":$params}" \
    --output setup.sh \
    https://demo.nsg.net.ru/api

chmod a+x ./setup.sh
./setup.sh&
